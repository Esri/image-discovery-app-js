//>>built
define("esriviewer/util/ViewerUtils",["dojo/_base/declare","dojo/window","dojo/keys","dojo/_base/lang","dojo/dom-style","dojox/uuid/Uuid","dojox/uuid/generateTimeBasedUuid","dojo/Deferred","dojo/topic","esri/request"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){return _1([],{isDebug:false,constructor:function(_b){this.html5UploadSupported=window.File&&window.FileReader&&window.FileList&&window.Blob;_4.mixin(this,_b||{});_6.setGenerator(_7);},isHtml5FileUploadSupported:function(){return this.html5UploadSupported;},debug:function(_c){if(this.isDebug){this.log(_c,VIEWER_GLOBALS.LOG_TYPE.INFO);}},log:function(_d,_e){if(_d==null||_d===""){return;}_9.publish(VIEWER_GLOBALS.EVENTS.LOGGING.ADD,_d,_e);},handleContainerMoved:function(_f,_10){var _11=false;var _12=false;if(_10.l<3){_5.set(_f.node,"left","3px");_11=true;}var _13=(VIEWER_GLOBALS.WINDOW&&VIEWER_GLOBALS.WINDOW.TOP_POSITION_MOVE_OFFSET)?(VIEWER_GLOBALS.WINDOW.TOP_POSITION_MOVE_OFFSET):3;if(_10.t<_13){_5.set(_f.node,"top",_13+"px");_12=true;}if(_11&&_12){return;}var _14=_2.getBox();if(!_11){var _15=_5.get(_f.node,"width");var _16=_5.get(_f.node,"left");var _17=_16+_15;if(_17>(_14.w-3)){_5.set(_f.node,"left",(_14.w-_15-3)+"px");}}if(!_12){var _18=_5.get(_f.node,"height");var _19=_5.get(_f.node,"top");var _1a=_19+_18;if(_1a>(_14.h-5)){_5.set(_f.node,"top",(_14.h-_18-5)+"px");}}},generateUUID:function(){var _1b=new _6();return _1b.toString();},getTimeStamp:function(){var _1c=new Date();var _1d=_1c.getHours();if(_1d<12){if(_1d==0){_1d=12;}}else{if(_1d!=12){_1d=_1d-12;}}_1d=_1d.toString();if(_1d.length<2){_1d="0"+_1d;}var _1e=_1c.getMinutes().toString();if(_1e.length<2){_1e="0"+_1e;}var _1f=_1c.getSeconds().toString();if(_1f.length<2){_1f="0"+_1f;}return _1d+":"+_1e+":"+_1f;},sendJsonPQuery:function(url,_20,_21,_22,_23){if(_22==null){_22=_4.hitch(this,function(_24){var msg="Could not resource : "+url+". Please verify URL is accessible.";VIEWER_UTILS.log(msg,VIEWER_GLOBALS.LOG_TYPE.ERROR);_9.publish(VIEWER_GLOBALS.EVENTS.MESSAGING.SHOW,msg);});}if(_23==null){_23="callback";}var _25={callbackParamName:_23,content:_20,url:url};_a(_25).then(_21,_22);},isEnterKey:function(e){return e.keyCode==_3.ENTER;},joinUrl:function(url,_26){var _27=url.lastIndexOf("/")==url.length-1;if(!_27){url+="/";}if(_26[0]==="/"){_26=_26.substring(1);}return url+_26;},getLayerInfoFromService:function(_28,_29,_2a,_2b){if(_2b==null){_2b="callback";}var _2c=_4.hitch(this,function(_2d){var msg="could not load layer from service: "+_2e;VIEWER_UTILS.log(msg,VIEWER_GLOBALS.LOG_TYPE.ERROR);_9.publish(VIEWER_GLOBALS.EVENTS.MESSAGING.SHOW,msg);});if(_28!=null&&_29!=null&&_2a){var _2e=_28+"/"+_29;}var _2f={callbackParamName:_2b,content:{f:"json"},url:_2e};_a(_2f).then(_2a,_2c);},endsWith:function(_30,_31){var _32=_30.lastIndexOf(_31);return (_32!=-1)&&(_32+_31.length==_30.length);},getFileExtension:function(_33){var _34=_33.lastIndexOf(".");if(_34<0||_34===_33.length-1){return "";}return _33.substr(_34+1);},getFileExtensionLower:function(_35){return this.getFileExtension(_35).toLowerCase();},getServiceTypeFromUrl:function(url){if(this.endsWith(url,VIEWER_GLOBALS.SERVICE_TYPES.MAP_SERVER)||this.endsWith(url,VIEWER_GLOBALS.SERVICE_TYPES.MAP_SERVER+"/")){return VIEWER_GLOBALS.SERVICE_TYPES.MAP_SERVER;}else{if(this.endsWith(url,VIEWER_GLOBALS.SERVICE_TYPES.IMAGE_SERVER)||this.endsWith(url,VIEWER_GLOBALS.SERVICE_TYPES.IMAGE_SERVER+"/")){return VIEWER_GLOBALS.SERVICE_TYPES.IMAGE_SERVER;}else{if(this.endsWith(url,VIEWER_GLOBALS.SERVICE_TYPES.GP_SERVER)||this.endsWith(url,VIEWER_GLOBALS.SERVICE_TYPES.GP_SERVER+"/")){return VIEWER_GLOBALS.SERVICE_TYPES.GP_SERVER;}else{if(this.endsWith(url,VIEWER_GLOBALS.SERVICE_TYPES.GLOBE_SERVER)||this.endsWith(url,VIEWER_GLOBALS.SERVICE_TYPES.GLOBE_SERVER+"/")){return VIEWER_GLOBALS.SERVICE_TYPES.GLOBE_SERVER;}else{if(this.endsWith(url,VIEWER_GLOBALS.SERVICE_TYPES.GEOCODE_SERVER)||this.endsWith(url,VIEWER_GLOBALS.SERVICE_TYPES.GEOCODE_SERVER+"/")){return VIEWER_GLOBALS.SERVICE_TYPES.GEOCODE_SERVER;}else{if(REG_EXP_UTILS.isKMLExtension(url)){return VIEWER_GLOBALS.SERVICE_TYPES.KML;}else{if(REG_EXP_UTILS.isFeatureLayer(url)){return VIEWER_GLOBALS.SERVICE_TYPES.FEATURE_SERVER;}else{return null;}}}}}}}},getServiceDescription:function(_36,_37,_38,_39){if(_39==null){_39="callback";}if(_38==null){_38=_4.hitch(this,function(_3a){var msg="Could not load service description for : "+_36+". Please verify service is online.";});}if(_36!=null&&_37){var _3b={callbackParamName:_39,content:{f:"json"},url:_36};_a(_3b).then(_37,_38);}},getLayerNameFromLayer:function(_3c){if(_3c.layerAliasName!=null&&_3c.layerAliasName!=""){return _3c.layerAliasName;}else{if(_3c.name!=null&&_3c.name!=""){return _3c.name;}else{if(_3c.id!=null){return _3c.id;}else{if(_3c.url!=null){return _3c.url;}}}}return "Layer";},getLabelForEsriUnit:function(_3d){if(_3d===VIEWER_GLOBALS.ESRI_UNITS.METERS){return "meters";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.FEET){return "feet";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.YARDS){return "yards";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.MILES){return "miles";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.NAUTICAL_MILES){return "nautical miles";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.MILLIMETERS){return "millimeters";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.CENTIMETERS){return "centimeters";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.DECIMETERS){return "decimeters";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.KILOMETERS){return "kilometers";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_MILES){return "square miles";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_METERS){return "square meters";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_KILOMETERS){return "square kilometers";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_ARES){return "square ares";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_HECTARES){return "square hectares";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_CENTIMETERS){return "square centimeters";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_DECIMETERS){return "square decimeters";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_FEET){return "square feet";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_INCHES){return "square inches";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_MILLIMETERS){return "square millimeters";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_YARDS){return "square yards";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_UNKNOWN){return "square unknown";}else{if(_3d===VIEWER_GLOBALS.ESRI_UNITS.DECIMAL_DEGREES){return "decimal degrees";}}}}}}}}}}}}}}}}}}}}}}return "unknown";},getShortLabelForEsriUnit:function(_3e){if(_3e===VIEWER_GLOBALS.ESRI_UNITS.METERS){return "m";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.FEET){return "f";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.YARDS){return "y";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.MILES){return "M";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.NAUTICAL_MILES){return "NM";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.MILLIMETERS){return "mm";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.CENTIMETERS){return "cm";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.DECIMETERS){return "dm";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.KILOMETERS){return "KM";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_MILES){return "square miles";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_METERS){return "Sq m";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_KILOMETERS){return "Sq KM";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_ARES){return "Sq Ares";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_HECTARES){return "Sq Hectares";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_CENTIMETERS){return "Sq cm";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_DECIMETERS){return "Sq dm";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_FEET){return "Sq f";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_INCHES){return "Sq in";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_MILLIMETERS){return "Sq mm";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_YARDS){return "Sq y";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.SQUARE_UNKNOWN){return "Sq unknown";}else{if(_3e===VIEWER_GLOBALS.ESRI_UNITS.DECIMAL_DEGREES){return "Dec. Deg.";}}}}}}}}}}}}}}}}}}}}}}return "Unknown";},getFieldTypeFromLayer:function(_3f,_40){var _41=_40.fields?_40.fields:(_40.serviceDescription?_40.serviceDescription.fields:[]);if(_40&&_41&&_3f){for(var i=0;i<_41.length;i++){if(_41[i].alias===_3f||_41[i].name===_3f){return _41[i].type;}}}return null;},getFileNameFromAtEndOfUrl:function(_42){if(_42==null||_42.lastIndexOf("/")<0){return "";}_42=_42.substring(0,(_42.indexOf("#")==-1)?_42.length:_42.indexOf("#"));_42=_42.substring(0,(_42.indexOf("?")==-1)?_42.length:_42.indexOf("?"));return _42.substring(_42.lastIndexOf("/")+1,_42.length);},getFileNameFromAtEndOfPath:function(_43){if(_43==null||_43.lastIndexOf("\\")<0){return "";}return _43.substring(_43.lastIndexOf("\\")+1,_43.length);},_intSorter:function(a,b){return a-b;},sortIntegerArray:function(arr){return arr.sort(this._intSorter);},validateUrl:function(url){var def=new _8();def.resolve(true);return def;},trim:function(str){return str.replace(/^\s*/,"").replace(/\s*$/,"");},getLayerUniqueId:function(_44){if(_44==null){return null;}if(_4.isString(_44)){return _44.toLowerCase();}var id;if(_44.url){id=_44.url.toLowerCase();}else{if(_44.id!=null){id=_44.id;}else{id="lyr_"+VIEWER_UTILS.generateUUID();_44.id=id;}}return id;}});});