//>>built
define("esriviewer/portal/PortalSupport",["dojo/_base/declare","dojo/topic","dojo/_base/lang","esri/arcgis/Portal","../base/ConfigurationEntryMixin","./PortalSearcher"],function(_1,_2,_3,_4,_5,_6){return _1([_5],{constructor:function(){this.portalConfiguration=null;this.loadViewerConfigurationData();if(this.portalConfiguration!=null&&_3.isObject(this.portalConfiguration)&&this.portalConfiguration.url!=null&&this.portalConfiguration.url!=""){this.initPortal();}else{VIEWER_UTILS.log("Portal Configuration not found",VIEWER_GLOBALS.LOG_TYPE.ERROR);}if(this.portal){this.initListeners();this._createPortalSearcher();}},initPortal:function(){this.portal=new _4.Portal(this.portalConfiguration.url);},initListeners:function(){_2.subscribe(VIEWER_GLOBALS.EVENTS.PORTAL.GET_INSTANCE,_3.hitch(this,this.handleGetPortalInstance));_2.subscribe(VIEWER_GLOBALS.EVENTS.PORTAL.LOG_IN,_3.hitch(this,this.handlePortalLogIn));_2.subscribe(VIEWER_GLOBALS.EVENTS.PORTAL.LOG_OUT,_3.hitch(this,this.handlePortalLogOut));_2.subscribe(VIEWER_GLOBALS.EVENTS.PORTAL.IS_USER_LOGGED_IN,_3.hitch(this,this.handleIsUserLoggedIn));},handleIsUserLoggedIn:function(_7){if(_7!=null&&_3.isFunction(_7)){_7(this.portal&&this.portal.getPortalUser()!=null);}},handlePortalLogOut:function(){this.portal.signOut();_2.publish(VIEWER_GLOBALS.EVENTS.PORTAL.USER_LOGGED_OUT);},handlePortalLogIn:function(_8){this.portal.signIn().then(_3.hitch(this,function(_9){_2.publish(VIEWER_GLOBALS.EVENTS.PORTAL.USER_LOGGED_IN,_9);if(_8!=null&&_3.isFunction(_8)){_8(_9);}}));},loadViewerConfigurationData:function(){var _a;_2.publish(VIEWER_GLOBALS.EVENTS.CONFIGURATION.GET_ENTRY,"portal",function(_b){_a=_b;});this.portalConfiguration=_a;},handleGetPortalInstance:function(_c){if(_c!=null&&_3.isFunction(_c)){_c(this.portal);}},_createPortalSearcher:function(){this.portalSearcher=new _6();}});});