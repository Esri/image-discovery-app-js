//>>built
define("esriviewer/map/base/MapExtentTools",["dojo/_base/declare","dojo/topic","dojo/_base/lang","esri/geometry/Extent","esri/geometry/Point"],function(_1,_2,_3,_4,_5){return _1([],{maxClientZoom:null,constructor:function(_6){_3.mixin(this,_6);this._initListeners();},_initListeners:function(){_2.subscribe(VIEWER_GLOBALS.EVENTS.MAP.EXTENT.PAN_TO,_3.hitch(this,this.panToPoint));_2.subscribe(VIEWER_GLOBALS.EVENTS.MAP.EXTENT.GET_CENTER,_3.hitch(this,this.handleGetCenter));_2.subscribe(VIEWER_GLOBALS.EVENTS.MAP.EXTENT.GET_EXTENT,_3.hitch(this,this.handleGetExtent));_2.subscribe(VIEWER_GLOBALS.EVENTS.MAP.EXTENT.GET_LEVEL,_3.hitch(this,this.handleGetLevel));_2.subscribe(VIEWER_GLOBALS.EVENTS.MAP.EXTENT.SET_LEVEL,_3.hitch(this,this.handleSetLevel));_2.subscribe(VIEWER_GLOBALS.EVENTS.MAP.DIMENSIONS.GET,_3.hitch(this,this.handleGetMapDimensions));_2.subscribe(VIEWER_GLOBALS.EVENTS.MAP.EXTENT.SET_EXTENT,_3.hitch(this,this.setMapExtent));},setMapExtent:function(_7){if(_7!=null&&_7 instanceof _4){if(_7.spatialReference.wkid==this.map.spatialReference.wkid){this.map.setExtent(_7);}else{_2.publish(VIEWER_GLOBALS.EVENTS.GEOMETRY_SERVICE.TASKS.PROJECT_TO_MAP_SR,_7,_3.hitch(this,function(_8){if(_3.isArray(_8)&&_8.length>0){if(this.maxClientZoom!=null){this.map.setLevel(this.maxClientZoom);}this.map.setExtent(_8[0]);}}));}}},handleGetMapDimensions:function(_9){if(_9!=null&&_3.isFunction(_9)){_9({width:this.map.width,height:this.map.height});}},handleMapExtentChanged:function(){this.mapDisplayWidgets.showScale();},panToPoint:function(_a,_b){var _c;if(!(_a instanceof _5)){return;}if(_b!=null&&_3.isObject(_b)){if(_b.zoomTo!=null&&_b.zoomTo===false){this.map.centerAt(_a);}else{if(_b.deepest!=null&&_b.deepest==true){if(_3.isObject(this.map.__tileInfo)&&_3.isArray(this.map.__tileInfo.lods)){_c=this.map.__tileInfo.lods.length-1;}}else{if(_b.zoomLevel!=null&&_3.isObject(this.map.__tileInfo)&&_3.isArray(this.map.__tileInfo.lods)){if(_c>=this.map.__tileInfo.lods.length){_c=this.map.__tileInfo.lods.length-1;}else{_c=_b.zoomLevel;}}}if(_c!=null){this.map.centerAndZoom(_a,_c);}}}else{if(this.map.getLevel()<8||this.map.getLevel()>15){_c=7;}else{_c=this.map.getLevel();}if(this.map.getLevel()==_c){this.map.centerAt(_a);}else{this.map.centerAndZoom(_a,_c);}}},handleSetLevel:function(_d){if(_d<this.map.__tileInfo.lods.length){this.map.setLevel(_d);}},handleGetLevel:function(_e){if(_e==null||!_3.isFunction(_e)){return;}_e(this.map.getLevel());},handleGetExtent:function(_f){if(_f==null||!_3.isFunction(_f)){return;}_f(this.map.extent);},handleGetCenter:function(_10){if(_10==null||!_3.isFunction(_10)){return;}_10(this.map.extent.getCenter());}});});