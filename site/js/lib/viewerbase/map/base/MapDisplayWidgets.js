//>>built
define("esriviewer/map/base/MapDisplayWidgets",["dojo/_base/declare","dojo/_base/lang","dojo/_base/window","dojo/dom-attr","dojo/dom-construct","dojo/dom-class","dojo/topic","dojo/_base/connect","esri/geometry/webMercatorUtils","esri/geometry/scaleUtils","esri/dijit/Scalebar"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){return _1([],{useFooterCoordPosition:false,_defaultMgrsPrecision:6,showMgrs:false,showLatLong:true,hideMapScale:false,showScaleBar:false,constructor:function(_c){_2.mixin(this,_c);this.mgrsPrecision=this._defaultMgrsPrecision;this.loadViewerConfigurationData();this.createMapScaleAndCoordsElement();this._initListeners();},loadViewerConfigurationData:function(){var _d=null;_7.publish(VIEWER_GLOBALS.EVENTS.CONFIGURATION.GET_ENTRY,"map",function(_e){_d=_e;});if(_d&&_2.isObject(_d)){if(_d.display!=null&&_2.isObject(_d.display)){if(_d.display.showScale!=null&&_d.display.showScale==false){this.hideMapScale=true;}if(_d.display.showScaleBar!=null&&_d.display.showScaleBar==true){this.showScaleBar=true;}if(_d.display.showMGRS!=null&&_d.display.showMGRS==true){this.showMgrs=true;}if(_d.display.showLatLong!=null&&_d.display.showLatLong==false){this.showLatLong=false;}if(_d.display.mgrsPrecision!=null){this.mgrsPrecision=parseInt(_d.display.mgrsPrecision,10);}}}var _f=null;_7.publish(VIEWER_GLOBALS.EVENTS.CONFIGURATION.GET_ENTRY,"footerTogglerWidget",function(_10){_f=_10;});this.useFooterCoordPosition=_f!=null&&_2.isObject(_f)&&_f.create;},_initListeners:function(){_7.subscribe(VIEWER_GLOBALS.EVENTS.MAP.INFO_WINDOW.HIDE,_2.hitch(this,this.handleHideInfoWindow));if(this.showLatLong||this.showMgrs){_8.connect(this.map,"onMouseMove",_2.hitch(this,this.showCoords));}},handleHideInfoWindow:function(){if(this.map&&this.map.infoWindow&&this.map.infoWindow.isShowing){this.map.infoWindow.hide();}},createMapScaleAndCoordsElement:function(){var _11=_5.create("div",{className:"threePixelBorderRadius mapalmanac"});if(this.useFooterCoordPosition){_6.add(_11,"mapScaleAndCoordsContainerWithFooter");}else{_6.add(_11,"mapScaleAndCoordsContainer");}if(!this.hideMapScale){this.scaleInfoElement=_5.create("span",{className:"mapScaleInfoInner"});_5.place(this.scaleInfoElement,_11);}if(this.showScaleBar){var _12=new _b({map:this.map,scalebarUnit:"dual"});}if(this.showLatLong||this.showMgrs){if(!this.hideMapScale){_5.place(_5.create("span",{innerHTML:"|"}),_11);}if(this.showLatLong){this.latLongCoordsInfoElement=_5.create("span",{className:"mapCoordsInfoInner"});_5.place(this.latLongCoordsInfoElement,_11);}if(this.showMgrs){if(this.showLatLong){_5.place(_5.create("span",{innerHTML:"|"}),_11);}this.mrgsCoordsInfoElement=_5.create("span",{className:"mapCoordsInfoInner"});_5.place(this.mrgsCoordsInfoElement,_11);}}_7.publish(VIEWER_GLOBALS.EVENTS.PLACEMENT.GLOBAL.PLACE.MAP_SCALE_AND_COORDINATES,_11);},showCoords:function(ext){try{if(this.latLongCoordsInfoElement||this.mrgsCoordsInfoElement){var pnt=_9.webMercatorToGeographic(ext.mapPoint||ext);if(this.latLongCoordsInfoElement){if(pnt===null||pnt===undefined){return;}_4.set(this.latLongCoordsInfoElement,"innerHTML","Lat: "+pnt.y.toFixed(2)+"&deg"+((pnt.y<0)?"S":"N")+"  Lon: "+pnt.x.toFixed(2)+"&deg"+((pnt.x<0)?"W":"E"));}if(this.mrgsCoordsInfoElement){_4.set(this.mrgsCoordsInfoElement,"innerHTML","MGRS: "+PROJECTION_UTILS.LLtoMGRS(pnt.y,pnt.x,this.mgrsPrecision));}}}catch(e){}},showScale:function(){var a=Math.round(_a.getScale(this.map));a>999&&a<=999999?a=Math.round(a/1000)+" K":a>999999?a=Math.round(a/1000000)+" M":a>0&&a<=999&&(a=Math.round(a)+" Ft");_4.set(this.scaleInfoElement,"innerHTML","Scale: 1 <b>:</b> "+a);}});});