//>>built
define("esriviewer/map/base/MapDisplayWidgets",["dojo/_base/declare","dojo/_base/lang","dojo/_base/window","dojo/dom-attr","dojo/dom-construct","dojo/dom-class","dojo/topic","esri/geometry/webMercatorUtils","esri/geometry/scaleUtils"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){return _1([],{useFooterCoordPosition:false,_defaultMgrsPrecision:6,showMgrs:false,showUTM:false,showLatLong:true,hideMapScale:false,showScaleBar:false,constructor:function(_a){_2.mixin(this,_a);this.mgrsPrecision=this._defaultMgrsPrecision;this.loadViewerConfigurationData();this.createMapScaleAndCoordsElement();this.initListeners();},loadViewerConfigurationData:function(){var _b=null;_7.publish(VIEWER_GLOBALS.EVENTS.CONFIGURATION.GET_ENTRY,"map",function(_c){_b=_c;});if(_b&&_2.isObject(_b)){if(_b.display!=null&&_2.isObject(_b.display)){if(_b.display.showScale!=null&&_b.display.showScale===false){this.hideMapScale=true;}if(_b.display.showScaleBar!=null&&_b.display.showScaleBar===true){this.showScaleBar=true;}if(_b.display.showMGRS!=null&&_b.display.showMGRS===true){this.showMgrs=true;}if(_b.display.showUTM!=null&&_b.display.showUTM===true){this.showUTM=true;}if(_b.display.showLatLong!=null&&_b.display.showLatLong===false){this.showLatLong=false;}if(_b.display.mgrsPrecision!=null){this.mgrsPrecision=parseInt(_b.display.mgrsPrecision,10);}}}var _d=null;_7.publish(VIEWER_GLOBALS.EVENTS.CONFIGURATION.GET_ENTRY,"footerTogglerWidget",function(_e){_d=_e;});this.useFooterCoordPosition=_d!=null&&_2.isObject(_d)&&_d.create;},initListeners:function(){_7.subscribe(VIEWER_GLOBALS.EVENTS.MAP.INFO_WINDOW.HIDE,_2.hitch(this,this.handleHideInfoWindow));if(this.showLatLong||this.showMgrs||this.showUTM){this.map.on("mouse-move",_2.hitch(this,this.showCoords));}},handleHideInfoWindow:function(){if(this.map&&this.map.infoWindow&&this.map.infoWindow.isShowing){this.map.infoWindow.hide();}},createMapScaleAndCoordsElement:function(){var _f=_5.create("div",{className:"threePixelBorderRadius mapalmanac defaultBackground"});if(this.useFooterCoordPosition){_6.add(_f,"mapScaleAndCoordsContainerWithFooter");}else{_6.add(_f,"mapScaleAndCoordsContainer");}if(!this.hideMapScale){this.scaleInfoElement=_5.create("span",{className:"mapScaleInfoInner"});_5.place(this.scaleInfoElement,_f);}if(this.showScaleBar){var _10=_5.create("div",{className:"threePixelBorderRadius  defaultBackground"});if(this.useFooterCoordPosition){_6.add(_10,"esriScalebarContainerWithFooter");}else{_6.add(_10,"esriScalebarContainer");}var _11=_5.create("div");_5.place(_11,_10);_5.place(_10,_3.body());require(["esri/dijit/Scalebar"],_2.hitch(this,function(_12){var _13=new _12({map:this.map,scalebarUnit:"dual"},_11);}));}if(this.showLatLong||this.showMgrs||this.showUTM){if(!this.hideMapScale){_5.place(_5.create("span",{innerHTML:"|"}),_f);}if(this.showLatLong){this.latLongCoordsInfoElement=_5.create("span",{className:"mapCoordsInfoInner"});_5.place(this.latLongCoordsInfoElement,_f);}if(this.showMgrs){if(this.showLatLong){_5.place(_5.create("span",{innerHTML:"|"}),_f);}this.mrgsCoordsInfoElement=_5.create("span",{className:"mapCoordsInfoInner"});_5.place(this.mrgsCoordsInfoElement,_f);}if(this.showUTM){if(this.showLatLong||this.showMgrs){_5.place(_5.create("span",{innerHTML:"|"}),_f);}this.utmCoordsInfoElement=_5.create("span",{className:"mapCoordsInfoInner"});_5.place(this.utmCoordsInfoElement,_f);}}_7.publish(VIEWER_GLOBALS.EVENTS.PLACEMENT.GLOBAL.PLACE.MAP_SCALE_AND_COORDINATES,_f);},showCoords:function(evt){try{if(this.latLongCoordsInfoElement||this.mrgsCoordsInfoElement||this.utmCoordsInfoElement){var pnt=_8.webMercatorToGeographic(evt.mapPoint||evt);if(this.latLongCoordsInfoElement){if(pnt===null||pnt===undefined){return;}_4.set(this.latLongCoordsInfoElement,"innerHTML","Lat: "+pnt.y.toFixed(2)+"&deg"+((pnt.y<0)?"S":"N")+"  Lon: "+pnt.x.toFixed(2)+"&deg"+((pnt.x<0)?"W":"E"));}if(this.mrgsCoordsInfoElement){_4.set(this.mrgsCoordsInfoElement,"innerHTML","<span style='font-weight:bold'>MGRS</span> "+PROJECTION_UTILS.LLtoMGRS(pnt.y,pnt.x,this.mgrsPrecision));}if(this.utmCoordsInfoElement){var _14=PROJECTION_UTILS.LLtoUTM(pnt.y,pnt.x);if(_14.northing==null||isNaN(_14.northing)){_14.northing="?";}else{_14.northing=_14.northing.toFixed(3);}if(_14.easting==null||isNaN(_14.easting)){_14.easting="?";}else{_14.easting=_14.easting.toFixed(3);}_4.set(this.utmCoordsInfoElement,"innerHTML","<span style='font-weight:bold'>UTM</span> "+"N: "+_14.northing+" E: "+_14.easting+"   Z: "+_14.zone);}}}catch(e){}},showScale:function(){var a=Math.round(_9.getScale(this.map));a>999&&a<=999999?a=Math.round(a/1000)+" K":a>999999?a=Math.round(a/1000000)+" M":a>0&&a<=999&&(a=Math.round(a)+" Ft");_4.set(this.scaleInfoElement,"innerHTML","<span style='font-weight:bold'>Scale</span> 1 <b>:</b> "+a);}});});