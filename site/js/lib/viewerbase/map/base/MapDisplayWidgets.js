//>>built
define("esriviewer/map/base/MapDisplayWidgets",["dojo/_base/declare","dojo/_base/lang","dojo/_base/window","dojo/dom-attr","dojo/dom-construct","dojo/dom-class","dojo/topic","esri/geometry/webMercatorUtils","esri/geometry/scaleUtils","esri/dijit/Scalebar"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){return _1([],{useFooterCoordPosition:false,_defaultMgrsPrecision:6,showMgrs:false,showUTM:false,showLatLong:true,hideMapScale:false,showScaleBar:false,constructor:function(_b){_2.mixin(this,_b);this.mgrsPrecision=this._defaultMgrsPrecision;this.loadViewerConfigurationData();this.createMapScaleAndCoordsElement();this.initListeners();},loadViewerConfigurationData:function(){var _c=null;_7.publish(VIEWER_GLOBALS.EVENTS.CONFIGURATION.GET_ENTRY,"map",function(_d){_c=_d;});if(_c&&_2.isObject(_c)){if(_c.display!=null&&_2.isObject(_c.display)){if(_c.display.showScale!=null&&_c.display.showScale==false){this.hideMapScale=true;}if(_c.display.showScaleBar!=null&&_c.display.showScaleBar==true){this.showScaleBar=true;}if(_c.display.showMGRS!=null&&_c.display.showMGRS==true){this.showMgrs=true;}if(_c.display.showUTM!=null&&_c.display.showUTM==true){this.showUTM=true;}if(_c.display.showLatLong!=null&&_c.display.showLatLong==false){this.showLatLong=false;}if(_c.display.mgrsPrecision!=null){this.mgrsPrecision=parseInt(_c.display.mgrsPrecision,10);}}}var _e=null;_7.publish(VIEWER_GLOBALS.EVENTS.CONFIGURATION.GET_ENTRY,"footerTogglerWidget",function(_f){_e=_f;});this.useFooterCoordPosition=_e!=null&&_2.isObject(_e)&&_e.create;},initListeners:function(){_7.subscribe(VIEWER_GLOBALS.EVENTS.MAP.INFO_WINDOW.HIDE,_2.hitch(this,this.handleHideInfoWindow));if(this.showLatLong||this.showMgrs||this.showUTM){this.map.on("mouse-move",_2.hitch(this,this.showCoords));}},handleHideInfoWindow:function(){if(this.map&&this.map.infoWindow&&this.map.infoWindow.isShowing){this.map.infoWindow.hide();}},createMapScaleAndCoordsElement:function(){var _10=_5.create("div",{className:"threePixelBorderRadius mapalmanac"});if(this.useFooterCoordPosition){_6.add(_10,"mapScaleAndCoordsContainerWithFooter");}else{_6.add(_10,"mapScaleAndCoordsContainer");}if(!this.hideMapScale){this.scaleInfoElement=_5.create("span",{className:"mapScaleInfoInner"});_5.place(this.scaleInfoElement,_10);}if(this.showScaleBar){var _11=new _a({map:this.map,scalebarUnit:"dual"});}if(this.showLatLong||this.showMgrs||this.showUTM){if(!this.hideMapScale){_5.place(_5.create("span",{innerHTML:"|"}),_10);}if(this.showLatLong){this.latLongCoordsInfoElement=_5.create("span",{className:"mapCoordsInfoInner"});_5.place(this.latLongCoordsInfoElement,_10);}if(this.showMgrs){if(this.showLatLong){_5.place(_5.create("span",{innerHTML:"|"}),_10);}this.mrgsCoordsInfoElement=_5.create("span",{className:"mapCoordsInfoInner"});_5.place(this.mrgsCoordsInfoElement,_10);}if(this.showUTM){if(this.showLatLong||this.showMgrs){_5.place(_5.create("span",{innerHTML:"|"}),_10);}this.utmCoordsInfoElement=_5.create("span",{className:"mapCoordsInfoInner"});_5.place(this.utmCoordsInfoElement,_10);}}_7.publish(VIEWER_GLOBALS.EVENTS.PLACEMENT.GLOBAL.PLACE.MAP_SCALE_AND_COORDINATES,_10);},showCoords:function(evt){try{if(this.latLongCoordsInfoElement||this.mrgsCoordsInfoElement||this.utmCoordsInfoElement){var pnt=_8.webMercatorToGeographic(evt.mapPoint||evt);if(this.latLongCoordsInfoElement){if(pnt===null||pnt===undefined){return;}_4.set(this.latLongCoordsInfoElement,"innerHTML","Lat: "+pnt.y.toFixed(2)+"&deg"+((pnt.y<0)?"S":"N")+"  Lon: "+pnt.x.toFixed(2)+"&deg"+((pnt.x<0)?"W":"E"));}if(this.mrgsCoordsInfoElement){_4.set(this.mrgsCoordsInfoElement,"innerHTML","<span style='font-weight:bold'>MGRS</span> "+PROJECTION_UTILS.LLtoMGRS(pnt.y,pnt.x,this.mgrsPrecision));}if(this.utmCoordsInfoElement){var _12=PROJECTION_UTILS.LLtoUTM(pnt.y,pnt.x);if(_12.northing==null||isNaN(_12.northing)){_12.northing="?";}else{_12.northing=_12.northing.toFixed(3);}if(_12.easting==null||isNaN(_12.easting)){_12.easting="?";}else{_12.easting=_12.easting.toFixed(3);}_4.set(this.utmCoordsInfoElement,"innerHTML","<span style='font-weight:bold'>UTM</span> "+"N: "+_12.northing+" E: "+_12.easting+"   Z: "+_12.zone);}}}catch(e){}},showScale:function(){var a=Math.round(_9.getScale(this.map));a>999&&a<=999999?a=Math.round(a/1000)+" K":a>999999?a=Math.round(a/1000000)+" M":a>0&&a<=999&&(a=Math.round(a)+" Ft");_4.set(this.scaleInfoElement,"innerHTML","<span style='font-weight:bold'>Scale</span> 1 <b>:</b> "+a);}});});