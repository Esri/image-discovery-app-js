//>>built
define("esriviewer/ui/query/base/QueryBuilderResultsGrid",["dojo/_base/declare","../../base/UIWidget","./QueryBuilderResultsGridBase","dojo/dom-construct","dojo/store/Observable","dojo/store/Memory","dojo/_base/lang","dojo/topic"],function(_1,_2,_3,_4,_5,_6,_7,_8){return _1([_2],{graphicField:"__graphic__",maxResults:300,resultsGridInitialized:false,internalFieldsLookup:{_storeId:"_storeId"},storeIdField:"_storeId",createGrid:function(_9){var _a=this.generateResultColumns(_9);this.store=new _5(new _6({data:[],idProperty:this.storeIdField}));this.grid=new _3({columns:_a,store:this.store});this.grid.on(".dgrid-row:click",_7.hitch(this,this.handleRowClick));_4.place(this.grid.domNode,this.domNode);this.startup();this.resultsGridInitialized=true;},handleRowClick:function(_b){var _c=this.grid.row(_b);var _d=_c.data[this.graphicField];if(_d!=null){_8.publish(VIEWER_GLOBALS.EVENTS.MAP.GRAPHICS.CENTER_AND_FLASH,_d);}},createNewStore:function(){this.store=new _5(new _6({data:[],idProperty:this.storeIdField}));this.grid.set("store",this.store);},clearResults:function(){if(this.grid){this.createNewStore();}},populateResults:function(_e){if(!this.resultsGridInitialized){this.createGrid(_e);}this.createNewStore();if(_e==null||_e.features==null){return;}var _f;var _10;for(var i=0;i<_e.features.length;i++){if(i+1==this.maxResults){break;}var _11={id:i};_11[this.storeIdField]=VIEWER_UTILS.generateUUID();_11[this.graphicField]=_e.features[i];_10=_e.features[i].attributes;_f=_7.mixin(_10,_11);this.store.add(_f);}},generateResultColumns:function(_12){var _13=[];if(_12&&_12.fields){for(var i=0;i<_12.fields.length;i++){_13.push({field:_12.fields[i].name,label:_12.fields[i].name,hidden:i>7});}}return _13;},startup:function(){if(this.grid){this.grid.startup();}}});});