//>>built
define("esriviewer/ui/layers/base/LayersTocWidgetContextMenu",["dojo/_base/declare","dojo/topic","dojo/on","dojo/_base/lang","dojo/dom-style","dojo/dom-attr","dijit/Menu","dijit/MenuItem","dijit/PopupMenuItem","dijit/registry","dojo/_base/connect"],function(_1,_2,on,_3,_4,_5,_6,_7,_8,_9,_a){return _1([],{showRemoveMenuItems:true,constructor:function(_b){_3.mixin(this,_b);this.initialize();},initialize:function(){this.createServerMenu();this.createGroupLayerMenu();this.createLayerMenu();this.createGraphicsLayerMenu();this.initListeners();},initListeners:function(){this.zoomToExtentMenuItem.on("click",_3.hitch(this,this.handleZoomToExtent));this.openMapServiceDescriptionMenu.on("click",_3.hitch(this,this.handleOpenMapServerDescriptionMenuRequest));this.confirmRemoveLayerMenuItem.on("click",_3.hitch(this,this.handleRemoveLayer));this.confirmRemoveGraphicLayerMenuItem.on("click",_3.hitch(this,this.handleRemoveGraphicsLayer));_a.connect(this.serverNodeMenu,"_openMyself",_3.hitch(this,this.handleServerMenuOpen));_a.connect(this.groupNodeMenu,"_openMyself",_3.hitch(this,this.handleGroupMenuOpen));_a.connect(this.graphicsLayerMenu,"_openMyself",_3.hitch(this,this.handleGraphicsLayerMenuOpen));},createServerMenu:function(){this.serverNodeMenu=new _6();this.zoomToExtentMenuItem=new _7({label:"Zoom To Extent",iconClass:"commonIcons16 locationGoTo"});this.openMapServiceDescriptionMenu=new _7({label:"View Service Description",iconClass:"serviceDescriptionIcon"});this.serverNodeMenu.addChild(this.zoomToExtentMenuItem);this.serverNodeMenu.addChild(this.openMapServiceDescriptionMenu);var _c=new _6();this.confirmRemoveLayerMenuItem=new _7({label:"Confirm",iconClass:"commonIcons16 question"});_c.addChild(this.confirmRemoveLayerMenuItem);this.removeServiceMenuItem=new _8({iconClass:"commonIcons16 delete",label:"Remove Layer",popup:_c});this.serverNodeMenu.addChild(this.removeServiceMenuItem);this.serverNodeMenu.startup();},createGraphicsLayerMenu:function(){this.graphicsLayerMenu=new _6();var _d=new _6();this.confirmRemoveGraphicLayerMenuItem=new _7({label:"Confirm",iconClass:"commonIcons16 question"});_d.addChild(this.confirmRemoveGraphicLayerMenuItem);this.removeGraphicLayerMenuItem=new _8({iconClass:"commonIcons16 delete",label:"Remove Graphics Layer",popup:_d});this.graphicsLayerMenu.addChild(this.removeGraphicLayerMenuItem);this.graphicsLayerMenu.startup();},createLayerMenu:function(){this.layerNodeMenu=new _6();this.layerNodeMenu.startup();},createGroupLayerMenu:function(){this.groupNodeMenu=new _6();this.groupNodeMenu.startup();_4.set(this.groupNodeMenu.domNode,"display","none");},handleGroupMenuOpen:function(){_4.set(this.groupNodeMenu.domNode,"display","none");return false;},bindNodeToGraphicsLayerMenu:function(_e){this.bindNode(_e,this.graphicsLayerMenu);},bindNodeToServerMenu:function(_f){this.bindNode(_f,this.serverNodeMenu);},bindNodeToGroupMenu:function(_10){this.bindNode(_10,this.groupNodeMenu);},bindNodeToLayerMenu:function(_11){this.bindNode(_11,this.layerNodeMenu);},bindNodeToNoContentMenu:function(_12){on(_12,"contextmenu",function(e){e.stopPropagation();});},bindNode:function(_13,_14){if(_13&&_14&&_14.bindDomNode){_14.bindDomNode(_13);}},handleRemoveGraphicsLayer:function(){if(this.currentGraphicsLayerNodeFromMenu&&this.currentGraphicsLayerNodeFromMenu.item){var _15=this.getTreeStore().getValue(this.currentGraphicsLayerNodeFromMenu.item,"layer");if(_15){_2.publish(VIEWER_GLOBALS.EVENTS.MAP.LAYERS.REMOVE,_15);}}},handleGraphicsLayerMenuOpen:function(e){this.currentGraphicsLayerNodeFromMenu=_9.getEnclosingWidget(e.target);if(this.currentGraphicsLayerNodeFromMenu&&this.currentGraphicsLayerNodeFromMenu.item){var _16=this.getTreeStore().getValue(this.currentGraphicsLayerNodeFromMenu.item,"layer");if(_16){if(_16.removable!=null&&_16.removable===true){this.removeGraphicLayerMenuItem.attr("disabled",false);}else{this.removeGraphicLayerMenuItem.attr("disabled",true);}}}},handleServerMenuOpen:function(e){this.currentServerNodeFromMenu=_9.getEnclosingWidget(e.target);if(this.currentServerNodeFromMenu&&this.currentServerNodeFromMenu.item){var _17=this.getTreeStore().getValue(this.currentServerNodeFromMenu.item,"layer");if(_17){if(_17.canRemove!=null&&_17.canRemove===true){this.removeServiceMenuItem.attr("disabled",false);}else{this.removeServiceMenuItem.attr("disabled",true);}}}},handleZoomToExtent:function(){if(this.currentServerNodeFromMenu&&this.currentServerNodeFromMenu.item){var _18=this.getTreeStore().getValue(this.currentServerNodeFromMenu.item,"layer");if(_18){_2.publish(VIEWER_GLOBALS.EVENTS.MAP.EXTENT.SET_EXTENT,_18.initialExtent);}}this.currentServerNodeFromMenu=null;},handleRemoveLayer:function(){if(this.currentServerNodeFromMenu&&this.currentServerNodeFromMenu.item){var _19=this.getTreeStore().getValue(this.currentServerNodeFromMenu.item,"layer");if(_19){if(_19.canRemove!=null&&_19.canRemove===true){_2.publish(VIEWER_GLOBALS.EVENTS.MAP.LAYERS.REMOVE,_19);}}}this.currentServerNodeFromMenu=null;},handleOpenMapServerDescriptionMenuRequest:function(){if(this.currentServerNodeFromMenu&&this.currentServerNodeFromMenu.item){var _1a=this.getTreeStore().getValue(this.currentServerNodeFromMenu.item,"layer");if(_1a&&_1a.url){this.openUrlInWindow(_1a.url);}}this.currentMapServerNodeFromMenu=null;},openUrlInWindow:function(url){if(url){window.open(url);}},getTreeStore:function(){return this.tree.model.store;}});});