//>>built
require({cache:{"url:esriviewer/ui/legend/template/MapLegendtemplate.html":"<div class=\"legendWindowContent\">\r\n    <div class=\"legendWidgetContainer\">\r\n        <div data-dojo-attach-point=\"legendWidgetContents\" class=\"legendWidgetContent\"></div>\r\n    </div>\r\n</div>","url:esriviewer/ui/legend/theme/MapLegendTheme.css":".legendWidgetContent{height:100%;overflow:auto;}"}});define("esriviewer/ui/legend/MapLegendWidget",["dojo/_base/declare","dojo/text!./template/MapLegendtemplate.html","xstyle/css!./theme/MapLegendTheme.css","dojo/topic","dojo/_base/lang","dojo/dom-construct","../base/UITemplatedWidget","esri/dijit/Legend"],function(_1,_2,_3,_4,_5,_6,_7,_8){return _1([_7],{startupCalled:false,templateString:_2,initListeners:function(){_4.subscribe(VIEWER_GLOBALS.EVENTS.MAP.LAYERS.REMOVED,_5.hitch(this,this.handleRefreshLegend));_4.subscribe(VIEWER_GLOBALS.EVENTS.MAP.LAYERS.ADDED,_5.hitch(this,this.handleRefreshLegend));this.operationalLayerResponseCallback=_5.hitch(this,this._handleLegendOperationalLayersResponse);},handleRefreshLegend:function(){if(this.legendWidget!=null){if(!this.startupCalled){this.startup();}_4.publish(VIEWER_GLOBALS.EVENTS.MAP.LAYERS.OPERATIONAL.GET,this.operationalLayerResponseCallback);}},_handleLegendOperationalLayersResponse:function(_9){if(_9){var _a=[];for(var _b in _9){_a.push({layer:_9[_b]});}}this.legendWidget.refresh(_a);},postCreate:function(){this.inherited(arguments);var _c=[];_4.publish(VIEWER_GLOBALS.EVENTS.MAP.LAYERS.OPERATIONAL.GET,function(_d){for(var _e in _d){_c.push({layer:_d[_e]});}});var _f;_4.publish(VIEWER_GLOBALS.EVENTS.MAP.GET,function(_10){_f=_10;});var _11={map:_f};if(_c.length>0){_11.layerInfos=_c;}this.legendWidget=new _8(_11,this.legendWidgetContents);},startup:function(){if(!this.startupCalled){try{this.legendWidget.startup();this.startupCalled=true;}catch(err){}}}});});