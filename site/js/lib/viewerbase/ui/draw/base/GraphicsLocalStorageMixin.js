//>>built
define("esriviewer/ui/draw/base/GraphicsLocalStorageMixin",["dojo/_base/declare","dojo/_base/lang","dojo/has","dojo/topic"],function(_1,_2,_3,_4){return _1([],{localStoragePersistSupported:true,constructor:function(){if(!(_3("ie")<8)){this.localStoragePersistSupported=false;}this.storageProvider=dojox.storage.manager.getProvider();if(this.storageProvider){this.localStoragePersistSupported=true;}this.persistedUserGraphics=this.loadPersistedUserGraphics();},deleteAllPersistedGraphics:function(){if(this.storageProvider){this.storageProvider.remove(VIEWER_GLOBALS.STORAGE.LABELS.USER_GRAPHICS);}},deleteUserPersistedGraphics:function(_5){if(this.persistUserGraphicsLabelExists(_5)){delete this.persistedUserGraphics[_5];this.persist();}var _6=false;for(var _7 in this.persistedUserGraphics){_6=true;break;}return _6;},persistUserGraphicsLabelExists:function(_8){return this.persistedUserGraphics[_8]!=null;},persistUserGraphics:function(_9,_a){if(_9==null||_9==""||_a==null||!_2.isArray(_a)||_a.length==0){return null;}if(this.persistUserGraphicsLabelExists(_9)){VIEWER_UTILS.log("Attempted to save graphics with an existing label: "+_9,VIEWER_GLOBALS.LOG_TYPE.ERROR);_4.publish(VIEWER_GLOBALS.EVENTS.MESSAGING.SHOW,"Cannot save graphics. Label already exists.");return null;}else{var _b=[];for(var i=0;i<_a.length;i++){_b.push({label:_a[i].label,graphic:_a[i].graphic.toJson()});}var _c={label:_9,graphics:_b};this.persistedUserGraphics[_9]=_c;this.persist();VIEWER_UTILS.log("Saved graphics with label: "+_9,VIEWER_GLOBALS.LOG_TYPE.INFO);_4.publish(VIEWER_GLOBALS.EVENTS.MESSAGING.SHOW,"Graphics Saved");return _c;}},loadPersistedUserGraphics:function(){if(this.storageProvider){if(this.storageProvider.hasKey(VIEWER_GLOBALS.STORAGE.LABELS.USER_GRAPHICS)){return this.storageProvider.get(VIEWER_GLOBALS.STORAGE.LABELS.USER_GRAPHICS);}}return {};},persist:function(){this.storageProvider.put(VIEWER_GLOBALS.STORAGE.LABELS.USER_GRAPHICS,this.persistedUserGraphics);}});});