//>>built
define("esriviewer/ui/identify/model/IdentifyWidgetViewModel",["dojo/_base/declare","dojo/Evented","dojo/_base/lang","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/ArcGISImageServiceLayer","esri/layers/FeatureLayer"],function(_1,_2,_3,_4,_5,_6){return _1([_2],{CLEAR_RESULTS:"clearResults",constructor:function(){var _7=this;this.identifyQueryVisible=ko.observable(true);this.identifyResultsVisible=ko.observable(false);this.serviceValuesCache={};this.services=ko.observableArray();this.layers=ko.observableArray();this.selectedService=ko.observable("");this.selectedLayer=ko.observable("");this.drawActive=ko.observable(false);this.showDrawContainer=ko.observable(false);this.showTabContainer=ko.observable(false);this.currentServiceIsMapService=ko.observable(false);this.showClearResults=ko.observable(false);this.identifyAdvancedOptionsVisible=ko.observable(false);this.selectedService.subscribe(_3.hitch(this,this.handleServiceChanged));this.hasSelectedService=ko.computed(function(){var _8=_7.selectedService();return _8!=null&&_8!="";});},clearResults:function(){this.showQuery();this.showTabContainer(false);this.showClearResults(false);this.emit(this.CLEAR_RESULTS);},showResults:function(){if(!this.showTabContainer()){this.showTabContainer(true);}this.identifyQueryVisible(false);this.identifyResultsVisible(true);},showQuery:function(){this.identifyQueryVisible(true);this.identifyResultsVisible(false);},toggleDrawActive:function(){this.drawActive(!this.drawActive());},serviceExists:function(_9){if(_9==null){return true;}var _a=this.services();var _b;var _c;for(var i=0;i<_a.length;i++){_b=_a[i].value;_c=VIEWER_UTILS.getLayerUniqueId(_b);if(_c==_9){return true;}}return false;},removeService:function(_d){if(_d==null){return;}var _e=this.services();var _f;var _10;for(var i=0;i<_e.length;i++){_f=_e[i].value;_10=VIEWER_UTILS.getLayerUniqueId(_f);if(_10==_d){this.services.remove(_e[i]);return;}}},handleServiceChanged:function(_11){this.layers.removeAll();if(_11==null||_11==""){this.showDrawContainer(false);this.currentServiceIsMapService(false);}else{var _12=false;var i;var _13=VIEWER_UTILS.getLayerUniqueId(_11);if(_13!=null&&this.serviceValuesCache[_13]!=null){var _14=this.serviceValuesCache[_13];if(_11 instanceof _4){this.currentServiceIsMapService(true);for(i=0;i<_14.length;i++){this.layers.push(_14[i]);}if(_14.length>0){_12=(_14.length>0);this.selectedLayer(_14[0].value);}}else{if(_11 instanceof _5||_11 instanceof _6){this.currentServiceIsMapService(false);_12=true;}}}else{var _15=[];var _16;this.serviceValuesCache[_13]=_15;if(_11 instanceof _4){this.currentServiceIsMapService(true);for(i=0;i<_11.layerInfos.length;i++){var _17=_11.layerInfos[i];if(_17.subLayerIds!=null){continue;}_16={label:_17.name,value:_17.id};_15.push(_16);this.layers.push(_16);}if(_11.layerInfos.length>0){_12=true;this.selectedLayer(_11.layerInfos[0].id);}}else{if(_11 instanceof _5||_11 instanceof _6){this.currentServiceIsMapService(false);_12=true;}}}this.showDrawContainer(_12);}},toggleIdentifyAdvancedOptions:function(){this.identifyAdvancedOptionsVisible(!this.identifyAdvancedOptionsVisible());}});});