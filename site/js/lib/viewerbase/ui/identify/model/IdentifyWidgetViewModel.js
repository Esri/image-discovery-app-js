//>>built
define("esriviewer/ui/identify/model/IdentifyWidgetViewModel",["dojo/_base/declare","dojo/Evented","dojo/_base/lang","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/ArcGISImageServiceLayer","esri/layers/FeatureLayer"],function(_1,_2,_3,_4,_5,_6){return _1([_2],{CLEAR_RESULTS:"clearResults",constructor:function(){var _7=this;this.identifyQueryVisible=ko.observable(true);this.identifyResultsVisible=ko.observable(false);this.serviceValuesCache={};this.services=ko.observableArray();this.layers=ko.observableArray();this.selectedService=ko.observable("");this.selectedLayer=ko.observable("");this.drawActive=ko.observable(false);this.showDrawContainer=ko.observable(false);this.showTabContainer=ko.observable(false);this.currentServiceIsMapService=ko.observable(false);this.showClearResults=ko.observable(false);this.identifyAdvancedOptionsVisible=ko.observable(false);this.selectedService.subscribe(_3.hitch(this,this.handleServiceChanged));this.hasSelectedService=ko.computed(function(){var _8=_7.selectedService();return _8!=null&&_8!="";});},clearResults:function(){this.showQuery();this.showTabContainer(false);this.showClearResults(false);this.emit(this.CLEAR_RESULTS);},showResults:function(){if(!this.showTabContainer()){this.showTabContainer(true);}this.identifyQueryVisible(false);this.identifyResultsVisible(true);},showQuery:function(){this.identifyQueryVisible(true);this.identifyResultsVisible(false);},toggleDrawActive:function(){this.drawActive(!this.drawActive());},serviceExists:function(_9){if(_9==null){return true;}var _a=_9.toLocaleLowerCase();var _b=this.services();var _c;for(var i=0;i<_b.length;i++){_c=_b[i].value;var _d=_c.url.toLowerCase();if(_d==_a){return true;}}return false;},removeService:function(_e){if(_e==null){return;}var _f=_e.toLocaleLowerCase();var _10=this.services();var _11;for(var i=0;i<_10.length;i++){_11=_10[i].value;var _12=_11.url.toLowerCase();if(_12==_f){this.services.remove(_10[i]);return;}}},handleServiceChanged:function(_13){this.layers.removeAll();if(_13==null||_13==""){this.showDrawContainer(false);this.currentServiceIsMapService(false);}else{var _14=false;var i;var _15=_13.url.toLowerCase();if(this.serviceValuesCache[_15]!=null){var _16=this.serviceValuesCache[_15];if(_13 instanceof _4){this.currentServiceIsMapService(true);for(i=0;i<_16.length;i++){this.layers.push(_16[i]);}if(_16.length>0){_14=(_16.length>0);this.selectedLayer(_16[0].value);}}else{if(_13 instanceof _5||_13 instanceof _6){this.currentServiceIsMapService(false);_14=true;}}}else{var _17=[];var _18;this.serviceValuesCache[_15]=_17;if(_13 instanceof _4){this.currentServiceIsMapService(true);for(i=0;i<_13.layerInfos.length;i++){var _19=_13.layerInfos[i];if(_19.subLayerIds!=null){continue;}_18={label:_19.name,value:_19.id};_17.push(_18);this.layers.push(_18);}if(_13.layerInfos.length>0){_14=true;this.selectedLayer(_13.layerInfos[0].id);}}else{if(_13 instanceof _5||_13 instanceof _6){this.currentServiceIsMapService(false);_14=true;}}}this.showDrawContainer(_14);}},toggleIdentifyAdvancedOptions:function(){this.identifyAdvancedOptionsVisible(!this.identifyAdvancedOptionsVisible());}});});