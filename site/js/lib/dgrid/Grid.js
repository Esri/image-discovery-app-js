//>>built
define("dgrid/Grid",["dojo/_base/kernel","dojo/_base/declare","dojo/on","dojo/has","put-selector/put","./List","dojo/_base/sniff"],function(_1,_2,_3,_4,_5,_6){var _7=_4("ie")<8&&!_4("quirks");var _8=/[^\._a-zA-Z0-9-]/g;function _9(_a,_b){if(_b&&_b.nodeType){_a.appendChild(_b);}};var _c=_2(_6,{columns:null,cellNavigation:true,tabableHeader:true,showHeader:true,column:function(_d){if(typeof _d=="string"){return this.columns[_d];}else{return this.cell(_d).column;}},listType:"grid",cell:function(_e,_f){if(_e.row&&_e.row instanceof this._Row){return _e;}if(_e.target&&_e.target.nodeType){_e=_e.target;}var _10;if(_e.nodeType){var _11;do{if(this._rowIdToObject[_e.id]){break;}var _12=_e.columnId;if(_12){_f=_12;_10=_e;break;}_e=_e.parentNode;}while(_e&&_e!=this.domNode);}if(!_10&&typeof _f!="undefined"){var row=this.row(_e),_13=row.element;if(_13){var _14=_13.getElementsByTagName("td");for(var i=0;i<_14.length;i++){if(_14[i].columnId==_f){_10=_14[i];break;}}}}if(_e!=null){return {row:row||this.row(_e),column:_f&&this.column(_f),element:_10};}},_columnsCss:function(_15){_15.fullSelector=function(){return this.parent.fullSelector()+" .dgrid-cell";};for(var i=0;i<_15.children.length;i++){var _16=_15.children[i];_16.field=_16.className=_16.selector.substring(1);}return _15.children;},createRowCells:function(tag,_17,_18){var row=_5("table.dgrid-row-table[role=presentation]"),_19=this.cellNavigation,_1a=(_4("ie")<9||_4("quirks"))?_5(row,"tbody"):row,tr,si,sl,i,l,_1b,_1c,id,_1d,_1e,_1f,_20,_21;_18=_18||this.subRows;for(si=0,sl=_18.length;si<sl;si++){_1b=_18[si];tr=(sl==1&&!_4("ie"))?_1a:_5(_1a,"tr");if(_1b.className){_5(tr,"."+_1b.className);}for(i=0,l=_1b.length;i<l;i++){_1c=_1b[i];id=_1c.id;_1d=_1c.className||(_1c.field&&"field-"+_1c.field);_1e=_5(tag+(".dgrid-cell.dgrid-cell-padding"+(id?".dgrid-column-"+id:"")+(_1d?"."+_1d:"")).replace(_8,"-")+"[role="+(tag==="th"?"columnheader":"gridcell")+"]");_1e.columnId=id;if(_7){_1f=_5(_1e,"!dgrid-cell-padding div.dgrid-cell-padding");_1e.contents=_1f;}else{_1f=_1e;}_20=_1c.colSpan;if(_20){_1e.colSpan=_20;}_21=_1c.rowSpan;if(_21){_1e.rowSpan=_21;}_17(_1f,_1c);tr.appendChild(_1e);}}return row;},left:function(_22,_23){return this.cell(this._move(_22,-(_23||1),"dgrid-cell"));},right:function(_24,_25){return this.cell(this._move(_24,_25||1,"dgrid-cell"));},renderRow:function(_26,_27){var row=this.createRowCells("td",function(td,_28){var _29=_26;if(_28.get){_29=_28.get(_26);}else{if("field" in _28&&_28.field!="_item"){_29=_29[_28.field];}}if(_28.formatter){td.innerHTML=_28.formatter(_29);}else{if(_28.renderCell){_9(td,_28.renderCell(_26,_29,td,_27));}else{if(_29!=null){td.appendChild(document.createTextNode(_29));}}}},_27&&_27.subRows);return _5("div[role=row]>",row);},renderHeader:function(){var _2a=this,_2b=this.columns,_2c=this.headerNode,i=_2c.childNodes.length;_2c.setAttribute("role","row");while(i--){_5(_2c.childNodes[i],"!");}var row=this.createRowCells("th",function(th,_2d){var _2e=_2d.headerNode=th;if(_7){th=th.parentNode;}var _2f=_2d.field;if(_2f){th.field=_2f;}if(_2d.renderHeaderCell){_9(_2e,_2d.renderHeaderCell(_2e));}else{if(_2d.label||_2d.field){_2e.appendChild(document.createTextNode(_2d.label||_2d.field));}}if(_2d.sortable!==false&&_2f&&_2f!="_item"){th.sortable=true;th.className+=" dgrid-sortable";}},this.subRows&&this.subRows.headerRows);this._rowIdToObject[row.id=this.id+"-header"]=this.columns;_2c.appendChild(row);_3(row,"click,keydown",function(_30){if(_30.type=="click"||_30.keyCode==32||(!_4("opera")&&_30.keyCode==13)){var _31=_30.target,_32,_33,_34,_35;do{if(_31.sortable){_2a._sortNode=_31;_32=_31.field||_31.columnId;_33=(_35=_2a._sort[0])&&_35.attribute==_32&&!_35.descending;return _2a.set("sort",_32,_33);}}while((_31=_31.parentNode)&&_31!=_2c);}});},resize:function(){var _36=this.headerNode.firstChild,_37=this.contentNode,_38;this.inherited(arguments);if(!_4("ie")||(_4("ie")>7&&!_4("quirks"))){_37.style.width="";if(_37&&_36){if((_38=_36.offsetWidth)!=_37.offsetWidth){_37.style.width=_38+"px";}}}},destroy:function(){this._destroyColumns();this.inherited(arguments);},_setSort:function(_39,_3a){this.inherited(arguments);if(this._lastSortedArrow){_5(this._lastSortedArrow,"<!dgrid-sort-up!dgrid-sort-down");_5(this._lastSortedArrow,"!");delete this._lastSortedArrow;}if(!this._sort[0]){return;}var _3b=this._sort[0].attribute,_3c=this._sort[0].descending,_3d=this._sortNode,_3e,_3f,i;delete this._sortNode;if(!_3d){_3e=this.columns;for(i in _3e){_3f=_3e[i];if(_3f.field==_3b){_3d=_3f.headerNode;break;}}}if(_3d){_3d=_3d.contents||_3d;this._lastSortedArrow=_5(_3d.firstChild,"-div.dgrid-sort-arrow.ui-icon[role=presentation]");this._lastSortedArrow.innerHTML="&nbsp;";_5(_3d,_3c?".dgrid-sort-down":".dgrid-sort-up");this.resize();}},styleColumn:function(_40,css){return this.addCssRule("#"+this.domNode.id+" .dgrid-column-"+_40,css);},_configColumns:function(_41,_42){var _43=[],_44=_42 instanceof Array,_45,_46;for(_45 in _42){_46=_42[_45];if(typeof _46=="string"){_42[_45]=_46={label:_46};}if(!_44&&!_46.field){_46.field=_45;}_45=_46.id=_46.id||(isNaN(_45)?_45:(_41+_45));if(_41){this.columns[_45]=_46;}if(this._configColumn){this._configColumn(_46,_45,_42,_41);}_46.grid=this;if(typeof _46.init==="function"){_46.init();}_43.push(_46);}return _44?_42:_43;},_destroyColumns:function(){var _47=this.subRows.length,i,j,_48,len;this.cleanup();for(i=0;i<_47;i++){for(j=0,len=this.subRows[i].length;j<len;j++){_48=this.subRows[i][j];if(typeof _48.destroy==="function"){_48.destroy();}}}},configStructure:function(){var _49=this.subRows;if(_49){this.columns={};for(var i=0;i<_49.length;i++){_49[i]=this._configColumns(i+"-",_49[i]);}}else{this.subRows=[this._configColumns("",this.columns)];}},_setColumns:function(_4a){this._destroyColumns();this.subRows=null;this.columns=_4a;this._updateColumns();},_setSubRows:function(_4b){this._destroyColumns();this.subRows=_4b;this._updateColumns();},setColumns:function(_4c){_1.deprecated("setColumns(...)","use set(\"columns\", ...) instead","dgrid 1.0");this.set("columns",_4c);},setSubRows:function(_4d){_1.deprecated("setSubRows(...)","use set(\"subRows\", ...) instead","dgrid 1.0");this.set("subRows",_4d);},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this.resize();}});_c.appendIfNode=_9;_c.defaultRenderCell=function(_4e,_4f,td,_50){if(_4f!=null){td.appendChild(document.createTextNode(_4f));}};return _c;});