//>>built
define("dgrid/List",["dojo/_base/array","dojo/_base/kernel","dojo/_base/declare","dojo/on","dojo/has","./util/misc","dojo/has!touch?./TouchScroll","xstyle/has-class","put-selector/put","dojo/_base/sniff","xstyle/css!./css/dgrid.css"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){_8("mozilla","opera","webkit","ie","ie-6","ie-6-7","quirks","no-quirks","touch");var _a;var _b=_9(document.getElementsByTagName("head")[0],"style"),_c=[],_d="dgrid-row-odd",_e="dgrid-row-even";_b=_b.sheet||_b.styleSheet;function _f(_10,css){var _11=_c.length;_c[_11]=(_b.cssRules||_b.rules).length;_b.addRule?_b.addRule(_10,css):_b.insertRule(_10+"{"+css+"}",_c[_11]);return {remove:function(){_12(_11);}};};function _12(_13){var _14=_c[_13],i,l=_c.length;if(_14===undefined){return;}_b.deleteRule?_b.deleteRule(_14):_b.removeRule(_14);_c[_13]=undefined;for(i=_13;i<l;i++){if(_c[i]>_14){_c[i]--;}}};function _15(id){return document.getElementById(id);};var _16=0;function _17(){return "dgrid_"+_16++;};var _18=/ +/g;function _19(cls){var _1a=cls?"."+cls.replace(_18,"."):"";if(this._class){_1a="!"+this._class.replace(_18,"!")+_1a;}_9(this.domNode,_1a);this._class=cls;};function _1b(){return this._class;};var _1c=_5("ie")<7&&!_5("quirks")?function(){var _1d,w,h,_1e;if(!this._started){return;}_1d=document.documentElement;w=_1d.clientWidth;h=_1d.clientHeight;_1e=this._prevWinDims||[];if(_1e[0]!==w||_1e[1]!==h){this.resize();this._prevWinDims=[w,h];}}:function(){if(this._started){this.resize();}};return _3(_7?_7:null,{tabableHeader:false,showHeader:false,showFooter:false,maintainOddEven:true,postscript:function(_1f,_20){var _21=this;(this._Row=function(id,_22,_23){this.id=id;this.data=_22;this.element=_23;}).prototype.remove=function(){_21.removeRow(this.element);};if(_20){this.srcNodeRef=_20=_20.nodeType?_20:_15(_20);}this.create(_1f,_20);},listType:"list",create:function(_24,_25){var _26=this.domNode=_25||_9("div"),cls;if(_24){this.params=_24;_3.safeMixin(this,_24);cls=_24["class"]||_24.className||_26.className;this._sort=_24.sort||[];delete this.sort;}else{this._sort=[];}this.observers=[];this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=_26.id=_26.id||this.id||_17();this.buildRendering();if(cls){_19.call(this,cls);}this.postCreate&&this.postCreate();delete this.srcNodeRef;if(this.domNode.offsetHeight){this.startup();}},buildRendering:function(){var _27=this.domNode,_28=this,_29,_2a,_2b,_2c,_2d;_2d=this.isRTL=(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase()=="rtl";_27.className="";_9(_27,"[role=grid].ui-widget.dgrid.dgrid-"+this.listType);_29=this.headerNode=_9(_27,"div.dgrid-header.dgrid-header-row.ui-widget-header"+(this.showHeader?"":".dgrid-header-hidden"));if(_5("quirks")||_5("ie")<8){_2a=_9(_27,"div.dgrid-spacer");}_2b=this.bodyNode=_9(_27,"div.dgrid-scroller");_2b.tabIndex=-1;this.headerScrollNode=_9(_27,"div.dgrid-header-scroll.dgrid-scrollbar-width.ui-widget-header");_2c=this.footerNode=_9("div.dgrid-footer"+(this.showFooter?"":".dgrid-footer-hidden"));_9(_27,_2c);if(_2d){_27.className+=" dgrid-rtl"+(_5("webkit")?"":" dgrid-rtl-nonwebkit");}_4(_2b,"scroll",function(_2e){if(_28.showHeader){_29.scrollLeft=_2e.scrollLeft||_2b.scrollLeft;}_2e.stopPropagation();_4.emit(_27,"scroll",{scrollTarget:_2b});});this.configStructure();this.renderHeader();this.contentNode=this.touchNode=_9(this.bodyNode,"div.dgrid-content.ui-widget-content");this._listeners.push(this._resizeHandle=_4(window,"resize",_6.throttleDelayed(_1c,this)));},startup:function(){this.inherited(arguments);if(this._started){return;}this._started=true;this.resize();this.set("sort",this._sort);},configStructure:function(){},resize:function(){var _2f=this.bodyNode,_30=this.headerNode,_31=this.footerNode,_32=_30.offsetHeight,_33=this.showFooter?_31.offsetHeight:0,_34=_5("quirks")||_5("ie")<7;this.headerScrollNode.style.height=_2f.style.marginTop=_32+"px";_2f.style.marginBottom=_33+"px";if(_34){_2f.style.height="";_2f.style.height=Math.max((this.domNode.offsetHeight-_32-_33),0)+"px";if(_33){_31.style.bottom="1px";setTimeout(function(){_31.style.bottom="";},0);}}if(!_a){var _35=_9(document.body,"div.dgrid-scrollbar-measure");_a=_35.offsetWidth-_35.clientWidth;_9(_35,"!");if(_5("ie")===7){_a++;}this.addCssRule(".dgrid-scrollbar-width","width: "+_a+"px");this.addCssRule(".dgrid-scrollbar-height","height: "+_a+"px");if(_a!=17&&!_34){this.addCssRule(".dgrid-header","right: "+_a+"px");this.addCssRule(".dgrid-rtl-nonwebkit .dgrid-header","left: "+_a+"px");}}if(_34){_30.style.width=_2f.clientWidth+"px";setTimeout(function(){_30.scrollLeft=_2f.scrollLeft;},0);}},addCssRule:_f,on:function(_36,_37){var _38=_4(this.domNode,_36,_37);if(!_5("dom-addeventlistener")){this._listeners.push(_38);}return _38;},cleanup:function(){var _39=this.observers,i;for(i in this._rowIdToObject){if(this._rowIdToObject[i]!=this.columns){var _3a=_15(i);if(_3a){this.removeRow(_3a,true);}}}for(i=0;i<_39.length;i++){var _3b=_39[i];_3b&&_3b.cancel();}this.observers=[];this.preload=null;},destroy:function(){if(this._listeners){for(var i=this._listeners.length;i--;){this._listeners[i].remove();}delete this._listeners;}this.cleanup();_9("!",this.domNode);},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoId=0;this.contentNode.innerHTML="";this.scrollTo({x:0,y:0});},newRow:function(_3c,_3d,to,_3e){if(!_3d||_3d.parentNode){var i=_3e.start+to;var row=this.insertRow(_3c,_3d?_3d.parentNode:this.contentNode,_3d,i,_3e);_9(row,".ui-state-highlight");setTimeout(function(){_9(row,"!ui-state-highlight");},250);return row;}},adjustRowIndices:function(_3f){if(this.maintainOddEven){var _40=_3f;var _41=_40.rowIndex;do{if(_40.rowIndex>-1){if((_40.className+" ").indexOf("dgrid-row ")>-1){_9(_40,"."+(_41%2==1?_d:_e)+"!"+(_41%2==0?_d:_e));}_40.rowIndex=_41++;}}while((_40=_40.nextSibling)&&_40.rowIndex!=_41);}},renderArray:function(_42,_43,_44){_44=_44||{};var _45=this,_46=_44.start||0,row,_47,_48;if(!_43){this._lastCollection=_42;}if(_42.observe){var _49=this.observers.push(_42.observe(function(_4a,_4b,to){var _4c,_4d;if(_4b>-1&&_47[_4b]){row=_47.splice(_4b,1)[0];if(row.parentNode==_48){_4c=row.nextSibling;if(_4c){if(_4b!=to){_4c.rowIndex--;}}_45.removeRow(row);}if(_45._processScroll){_45._processScroll();}}if(to>-1){_4d=_47[to];if(!_4d){_4d=_47[to-1];if(_4d){_4d=(_4d.connected||_4d).nextSibling;}}row=_45.newRow(_4a,_4d,to,_44);if(row){row.observerIndex=_49;_47.splice(to,0,row);if(!_4c||to<_4b){var _4e=row.previousSibling;_4c=!_4e||_4e.rowIndex+1==row.rowIndex||row.rowIndex==0?row:_4e;}}_44.count++;}_4b!=to&&_4c&&_45.adjustRowIndices(_4c);},true))-1;}var _4f=document.createDocumentFragment();if(_42.map){_47=_42.map(_50,console.error);if(_47.then){return _47.then(_51);}}else{_47=[];for(var i=0,l=_42.length;i<l;i++){_47[i]=_50(_42[i]);}}var _52;function _50(_53){_52=_45.insertRow(_53,_4f,null,_46++,_44);_52.observerIndex=_49;return _52;};function _51(_54){_48=_43?_43.parentNode:_45.contentNode;if(_48){_48.insertBefore(_4f,_43||null);_52=_54[_54.length-1];_52&&_45.adjustRowIndices(_52);}return (_47=_54);};return _51(_47);},renderHeader:function(){},_autoId:0,insertRow:function(_55,_56,_57,i,_58){var _59=_58.parentId,id=this.id+"-row-"+(_59?_59+"-":"")+((this.store&&this.store.getIdentity)?this.store.getIdentity(_55):this._autoId++),row=_15(id),_5a=row&&row.previousSibling;if(!row||(_57&&row.parentNode!=_57.parentNode)){if(row){this.removeRow(row);}row=this.renderRow(_55,_58);row.className=(row.className||"")+" ui-state-default dgrid-row "+(i%2==1?_d:_e);this._rowIdToObject[row.id=id]=_55;}_56.insertBefore(row,_57||null);if(_5a){this.adjustRowIndices(_5a);}row.rowIndex=i;return row;},renderRow:function(_5b,_5c){return _9("div",""+_5b);},removeRow:function(_5d,_5e){_5d=_5d.element||_5d;delete this._rowIdToObject[_5d.id];if(!_5e){_9(_5d,"!");}},row:function(_5f){var id;if(_5f instanceof this._Row){return _5f;}if(_5f.target&&_5f.target.nodeType){_5f=_5f.target;}if(_5f.nodeType){var _60;do{var _61=_5f.id;if((_60=this._rowIdToObject[_61])){return new this._Row(_61.substring(this.id.length+5),_60,_5f);}_5f=_5f.parentNode;}while(_5f&&_5f!=this.domNode);return;}if(typeof _5f=="object"){id=this.store.getIdentity(_5f);}else{id=_5f;_5f=this._rowIdToObject[this.id+"-row-"+id];}return new this._Row(id,_5f,_15(this.id+"-row-"+id));},cell:function(_62){return {row:this.row(_62)};},_move:function(_63,_64,_65,_66){var _67,_68,_69;_69=_68=_63.element;_64=_64||1;do{if((_67=_68[_64<0?"previousSibling":"nextSibling"])){do{_68=_67;if(_68&&(_68.className+" ").indexOf(_65+" ")>-1){_69=_68;_64+=_64<0?1:-1;break;}}while((_67=(!_66||!_68.hidden)&&_68[_64<0?"lastChild":"firstChild"]));}else{_68=_68.parentNode;if(_68===this.bodyNode||_68===this.headerNode){break;}}}while(_64);return _69;},up:function(row,_6a,_6b){return this.row(this._move(row,-(_6a||1),"dgrid-row",_6b));},down:function(row,_6c,_6d){return this.row(this._move(row,_6c||1,"dgrid-row",_6d));},scrollTo:_5("touch")?function(){return this.inherited(arguments);}:function(_6e){if(typeof _6e.x!=="undefined"){this.bodyNode.scrollLeft=_6e.x;}if(typeof _6e.y!=="undefined"){this.bodyNode.scrollTop=_6e.y;}},getScrollPosition:_5("touch")?function(){return this.inherited(arguments);}:function(){return {x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop};},get:function(_6f){var fn="_get"+_6f.charAt(0).toUpperCase()+_6f.slice(1);if(typeof this[fn]==="function"){return this[fn].apply(this,[].slice.call(arguments,1));}if(!1&&typeof this[fn+"Attr"]==="function"){}return this[_6f];},set:function(_70,_71){if(typeof _70==="object"){for(var k in _70){this.set(k,_70[k]);}}else{var fn="_set"+_70.charAt(0).toUpperCase()+_70.slice(1);if(typeof this[fn]==="function"){this[fn].apply(this,[].slice.call(arguments,1));}else{if(!1&&typeof this[fn+"Attr"]==="function"){}this[_70]=_71;}}return this;},_getClass:_1b,_setClass:_19,_getClassName:_1b,_setClassName:_19,_setSort:function(_72,_73){this._sort=typeof _72!="string"?_72:[{attribute:_72,descending:_73}];this.refresh();if(this._lastCollection){if(_72.length){if(typeof _72!="string"){_73=_72[0].descending;_72=_72[0].attribute;}this._lastCollection.sort(function(a,b){var _74=a[_72],_75=b[_72];if(_74===undefined){_74="";}if(_75===undefined){_75="";}return _74==_75?0:(_74>_75==!_73?1:-1);});}this.renderArray(this._lastCollection);}},sort:function(_76,_77){_2.deprecated("sort(...)","use set(\"sort\", ...) instead","dgrid 1.0");this.set("sort",_76,_77);},_getSort:function(){return this._sort;},_setShowHeader:function(_78){var _79=this.headerNode;this.showHeader=_78;_9(_79,(_78?"!":".")+"dgrid-header-hidden");this.renderHeader();this.resize();if(_78){_79.scrollLeft=this.getScrollPosition().x;}},setShowHeader:function(_7a){_2.deprecated("setShowHeader(...)","use set(\"showHeader\", ...) instead","dgrid 1.0");this.set("showHeader",_7a);},_setShowFooter:function(_7b){this.showFooter=_7b;_9(this.footerNode,(_7b?"!":".")+"dgrid-footer-hidden");this.resize();}});});