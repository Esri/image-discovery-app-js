//>>built
define("dgrid/extensions/ColumnReorder",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/on","dojo/query","dojo/dnd/Source","put-selector/put","xstyle/css!../css/extensions/ColumnReorder.css"],function(_1,_2,_3,on,_4,_5,_6){var _7=/-(\d+)(?:-(\d+))?$/;function _8(_9,_a){var _b=_a[2],_c=_9[_b?"columnSets":"subRows"][_a[1]];return _b?_c[_a[2]]:_c;};function _d(_e,_f,_10){if(_f[2]){_e.columnSets[_f[1]][_f[2]]=_10;}else{_e.subRows[_f[1]]=_10;}};var _11=_2(_5,{copyState:function(){return false;},checkAcceptance:function(_12,_13){return _12==this;},_legalMouseDown:function(evt){return evt.target.className.indexOf("dgrid-resize-handle")>-1?false:this.inherited(arguments);},onDropInternal:function(_14){var _15=this.grid,_16=_7.exec(_14[0].getAttribute("dndType")),_17=_16[2]?"columnSets":"subRows",_18=_8(_15,_16),_19=_15.columns;this.inherited(arguments);if(!_16){return;}setTimeout(function(){var _1a=_3.map(_14[0].parentNode.childNodes,function(col){return _19[col.columnId];}),_1b;_d(_15,_16,_1a);_1b={grid:_15,subRow:_1a,column:_19[_14[0].columnId],bubbles:true,cancelable:true,parentType:"dnd"};_1b[_17]=_15[_17];if(on.emit(_15.domNode,"dgrid-columnreorder",_1b)){_15.set(_17,_15[_17]);}else{_d(_15,_16,_18);_15.renderHeader();}},0);}});var _1c=_2(null,{columnDndConstructor:_11,_initSubRowDnd:function(_1d,_1e){var _1f,c,len,col,th;for(c=0,len=_1d.length;c<len;c++){col=_1d[c];if(col.reorderable===false){continue;}th=col.headerNode;if(th.tagName!="TH"){th=th.parentNode;}_6(th,".dojoDndItem[dndType="+_1e+"]");if(!_1f){_1f=th.parentNode;}}if(_1f){this._columnDndSources.push(new this.columnDndConstructor(_1f,{horizontal:true,grid:this}));}},renderHeader:function(){var _20="dgrid-"+this.id+"-",_21,cs;this.inherited(arguments);this._columnDndSources=[];if(this.columnSets){for(cs=0,_21=this.columnSets.length;cs<_21;cs++){_3.forEach(this.columnSets[cs],function(_22,sr){this._initSubRowDnd(_22,_20+cs+"-"+sr);},this);}}else{_3.forEach(this.subRows,function(_23,sr){this._initSubRowDnd(_23,_20+sr);},this);}},_destroyColumns:function(){if(this._columnDndSources){_3.forEach(this._columnDndSources,function(_24){_24.destroy();});}this.inherited(arguments);}});_1c.ColumnDndSource=_11;return _1c;});