//>>built
define("dgrid/selector",["dojo/_base/kernel","dojo/_base/array","dojo/on","dojo/aspect","dojo/_base/sniff","put-selector/put"],function(_1,_2,on,_3,_4,_5){return function(_6,_7){var _8=[],_9,_a;if(!_6){_6={};}if(_6.type){_6.selectorType=_6.type;_1.deprecated("columndef.type","use columndef.selectorType instead","dgrid 1.0");}_6.selectorType=_7=_7||_6.selectorType||"checkbox";_6.sortable=false;function _b(_c){return function(_d){var _e=_d.rows,_f=_e.length,_10="false",_11,_12,i;for(i=0;i<_f;i++){var _13=_9.cell(_e[i],_6.id).element;if(!_13){continue;}_13=(_13.contents||_13).input;if(!_13.disabled){_13.checked=_c;_13.setAttribute("aria-checked",_c);}}if(_a.type=="checkbox"){_11=_9.selection;_12=false;for(i in _11){if(_11[i]!=_9.allSelected){_12=true;break;}}_a.indeterminate=_12;_a.checked=_9.allSelected;if(_12){_10="mixed";}else{if(_9.allSelected){_10="true";}}_a.setAttribute("aria-checked",_10);}};};function _14(_15){if(_15.type=="click"||_15.keyCode==32||(!_4("opera")&&_15.keyCode==13)||_15.keyCode===0){var row=_9.row(_15),_16=_9._lastSelected&&_9.row(_9._lastSelected);_9._selectionTriggerEvent=_15;if(_7=="radio"){if(!_16||_16.id!=row.id){_9.clearSelection();_9.select(row,null,true);_9._lastSelected=row.element;}}else{if(row){if(_15.shiftKey){_b(true)({rows:[row]});}else{_16=null;}_16=_15.shiftKey?_16:null;_9.select(_16||row,row,_16?undefined:null);_9._lastSelected=row.element;}else{_5(this,(_9.allSelected?"!":".")+"dgrid-select-all");_9[_9.allSelected?"clearSelection":"selectAll"]();}}_9._selectionTriggerEvent=null;}};function _17(){_9._hasSelectorInputListener=true;_8.push(_3.before(_9,"_initSelectionEvents",function(){this.on(".dgrid-selector:click,.dgrid-selector:keydown",_14);}));var _18=_9._handleSelect;_9._handleSelect=function(_19){if(this.cell(_19).column!=_6){_18.apply(this,arguments);}};if(typeof _6.disabled=="function"){var _1a=_9.allowSelect;_9.allowSelect=function(row){return _1a.call(this,row)&&!_6.disabled(row.data);};}_8.push(_9.on("dgrid-select",_b(true)));_8.push(_9.on("dgrid-deselect",_b(false)));};var _1b=_6.disabled;var _1c=typeof _7=="function"?_7:function(_1d,_1e,_1f){var _20=_1e.parentNode;_5(_20&&_20.contents?_20:_1e,".dgrid-selector");var _21=_1e.input||(_1e.input=_5(_1e,"input[type="+_7+"]",{tabIndex:isNaN(_6.tabIndex)?-1:_6.tabIndex,disabled:_1b&&(typeof _1b=="function"?_1b(_1f):_1b),checked:_1d}));_21.setAttribute("aria-checked",!!_1d);if(!_9._hasSelectorInputListener){_17();}return _21;};_3.after(_6,"init",function(){_9=_6.grid;});_3.after(_6,"destroy",function(){_2.forEach(_8,function(l){l.remove();});_9._hasSelectorInputListener=false;});_6.renderCell=function(_22,_23,_24,_25,_26){var row=_22&&_9.row(_22);_23=row&&_9.selection[row.id];_1c(_23,_24,_22);};_6.renderHeaderCell=function(th){var _27=_6.label||_6.field||"";if(_7=="radio"||!_9.allowSelectAll){th.appendChild(document.createTextNode(_27));if(!_9._hasSelectorInputListener){_17();}}else{_1c(false,th,{});}_a=th.lastChild;};return _6;};});